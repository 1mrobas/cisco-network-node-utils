# interface
---
_template:
  context: ["interface <name>"]
  cli_ios_xr:
    get_command: "show running interface"
  cli_nexus:
    get_command: "show running interface all"

access_vlan:
  _exclude: [cli_ios_xr]
  kind: int
  get_value: '/^switchport access vlan (.*)$/'
  set_value: "switchport access vlan <vlan>"
  default_value: 1

all_interfaces:
  multiple:
  get_context: ~
  get_value: '/^interface (.*)/'

channel_group:
  kind: int
  default_value: false
  cli_nexus:
    get_value: '/^channel-group (\d+)$/'
    set_value: "<state> channel-group <val> <force>"
  cli_ios_xr:
    get_value: '/^bundle id (\d+).*$/'
    set_value: "<state> bundle id <val>"

create:
  set_context: ~
  set_value: "interface <name>"

description:
  kind: string
  get_value: '/^description (.*)/'
  set_value: "<state> description <desc>"
  default_value: ""

destroy:
  set_context: ~
  set_value: "no interface <name>"

duplex:
  _exclude: [cli_ios_xr]
  kind: string
  get_value: '/^duplex (.*)$/'
  set_value: "duplex <duplex>"
  default_value: "auto"

encapsulation_dot1q:
  kind: int
  default_value: ""
  get_value: '/^encapsulation dot1q (.*)/'
  set_value: "<state> encapsulation dot1q <vlan>"

feature_lacp:
  kind: boolean
  cli_nexus:
    get_command: "show running | i ^feature"
    context: ~
    get_value: '/^feature lacp$/'
    set_value: "%s feature lacp"
  cli_ios_xr:
    default_only: true

feature_vlan:
  _exclude: [cli_ios_xr]
  cli_nexus:
    kind: boolean
    get_command: "show running | i ^feature"
    context: ~
    get_value: '/^feature interface-vlan$/'
    set_value: "%s feature interface-vlan"

ipv4_addr_mask:
  # This handles both primary and secondary addresses
  multiple:
  cli_nexus:
    get_value: '/^ip address ([0-9\.]+)[\s\/](.*)/'
    set_value: "<state> ip address <addr>"
  cli_ios_xr:
    get_value: '/^ipv4 address ([0-9\.]+) (.*)/'
    set_value: '<state> ipv4 address <addr>'

ipv4_address:
  default_value: ~

ipv4_netmask_length:
  default_value: ~

ipv4_proxy_arp:
  kind: boolean
  default_value: false
  cli_nexus:
    get_value: '/^ip proxy-arp$/'
    set_value: "<state> ip proxy-arp"
  cli_ios_xr:
    get_value: '/^proxy-arp$/'
    set_value: "<state> proxy-arp"

ipv4_redirects_loopback:
  kind: boolean
  cli_nexus:
    default_only: false
  cli_ios_xr:
    get_value: '/^((?:no )?ipv4 redirects)$/'
    set_value: "<state> ipv4 redirects"
    default_value: false
    test_get_value: [
    '/^\s+ipv4 redirects/',
    '/^\s+no ipv4 redirects/'
    ]

ipv4_redirects_other_interfaces:
  kind: boolean
  test_config_result:
    false: false
    true: true
  cli_nexus:
    get_value: '/^((?:no )?ip redirects)$/'
    set_value: "<state> ip redirects"
    default_value: true
    test_get_value: [
    '/^\s+ip redirects/',
    '/^\s+no ip redirects/'
    ]
  cli_ios_xr:
    get_value: '/^((?:no )?ipv4 redirects)$/'
    set_value: "<state> ipv4 redirects"
    default_value: false
    test_get_value: [
    '/^\s+ipv4 redirects/',
    '/^\s+no ipv4 redirects/'
    ]

mtu_loopback:
  kind: boolean
  default_only: ~

mtu_other_interfaces:
  kind: int
  get_value: '/^mtu (.*)$/'
  set_value: "<state> mtu <mtu>"
  cli_nexus:
    default_value: 1500
  cli_ios_xr:
    default_value: 1514

negotiate_auto_ethernet:
  kind: boolean
  _exclude: [cli_ios_xr]
  test_get_value: [
  '/^\s+no negotiate auto/',
  '/^\s+negotiate auto/'
  ]
  /(N7K|C3064)/:
    default_only: false
  else:
    get_value: '/^(no )?negotiate auto$/'
    set_value: "<state> negotiate auto"
    default_value: true

negotiate_auto_other_interfaces:
  kind: boolean
  _exclude: [cli_ios_xr]
  default_only: false

negotiate_auto_portchannel:
  kind: boolean
  _exclude: [cli_ios_xr]
  cli_nexus:
    test_get_value: [
    '/^\s+no negotiate auto/',
    '/^\s+negotiate auto/'
    ]
    /N7K/:
      default_only: false
    else:
      get_value: '/^(no )?negotiate auto$/'
      set_value: "<state> negotiate auto"
      default_value: true

shutdown:
  kind: boolean
  get_value: '/^shutdown$/'
  set_value: "<state> shutdown"

shutdown_ether_channel:
  default_value: false

shutdown_ethernet_noswitchport_noshutdown:
  default_value: false

shutdown_ethernet_noswitchport_shutdown:
  default_value: false

shutdown_ethernet_switchport_noshutdown:
  default_value: false

shutdown_ethernet_switchport_shutdown:
  default_value: true

shutdown_loopback:
  default_value: false

shutdown_unknown:
  default_value: true

shutdown_vlan:
  cli_nexus:
    default_value: true

speed:
  _exclude: [cli_ios_xr]
  get_value: '/^speed (.*)$/'
  set_value: "speed <speed>"
  default_value: "auto"

svi_autostate:
  _exclude: [cli_ios_xr]
  kind: boolean
  get_value: '/^(?:no )?autostate$/'
  set_value: "<state> autostate"
  default_value: true

svi_management:
  _exclude: [cli_ios_xr]
  kind: boolean
  get_value: '/^management$/'
  set_value: "<state> management"
  default_value: false

switchport:
  _exclude: [cli_ios_xr]
  kind: boolean
  get_value: '/^switchport$/'
  set_value: "<state> switchport"
  # default_value: n/a. This is derived from system_default_switchport

switchport_autostate_exclude:
  _exclude: [cli_ios_xr]
  kind: boolean
  get_value: '/(^switchport autostate exclude)/'
  set_value: "<state> switchport autostate exclude"
  default_value: false

switchport_mode_dot1q_tunnel:
  _exclude: [cli_ios_xr]
  default_only: ""

switchport_mode_ethernet:
  _exclude: [cli_ios_xr]
  auto_default: false
  get_value: '/^(?:no )?switchport mode ?(.*)$/'
  set_value: "<state> switchport mode <mode>"
  default_value: "access"

switchport_mode_other_interfaces:
  _exclude: [cli_ios_xr]
  default_only: ""

switchport_mode_port_channel:
  _exclude: [cli_ios_xr]
  get_value: '/^switchport mode (.*)$/'
  set_value: "<state> switchport mode <mode>"
  default_value: ""

switchport_trunk_allowed_vlan:
  _exclude: [cli_ios_xr]
  get_value: '/^switchport trunk allowed vlan (.*)$/'
  set_value: "<state> switchport trunk allowed vlan <vlan>"
  default_value: "1-4094"

switchport_trunk_native_vlan:
  _exclude: [cli_ios_xr]
  kind: int
  get_value: '/^switchport trunk native vlan (.*)$/'
  set_value: "<state> switchport trunk native vlan <vlan>"
  default_value: 1

system_default_svi_autostate:
  kind: boolean
  cli_nexus:
    get_command: "show running all | include 'system default'"
    get_context: ~
    get_value: ['/^system default interface-vlan autostate$/']
    # default_value: n/a. This is a user-configurable system default.
  cli_ios_xr:
    default_only: false

system_default_switchport:
  kind: boolean
  cli_nexus:
    get_command: "show running all | include 'system default'"
    get_context: ~
    get_value: ['/^no system default switchport$/']
    default_value: true
  cli_ios_xr:
    default_only: false

system_default_switchport_shutdown:
  kind: boolean
  cli_nexus:
    get_command: "show running all | include 'system default'"
    get_context: ~
    get_value: ['/^system default switchport shutdown$/']
    # default_value: n/a. This is a user-configurable system default.
  cli_ios_xr:
    default_only: true

vrf:
  default_value: ""
  cli_nexus:
    get_value: '/^vrf member (.*)/'
    set_value: "<state> vrf member <vrf>"
  cli_ios_xr:
    get_value: '/^vrf (.*)/'
    set_value: "<state> vrf <vrf>"

vtp:
  _exclude: [cli_ios_xr]
  kind: boolean
  get_value: '/^vtp *$/'
  set_value: "<state> vtp"
  default_value: false
