# Command Reference N7K
#
# For documentation please see these files for fields and defaults:
#   - README_YAML.md
#   - command_reference_common.yaml
#
---
fabricpath:
  aggregate_multicast_routes:
    config_get: "show run fabricpath"
    config_get_token: '/^fabricpath multicast (aggregate\-routes)/'
    config_set: "%s fabricpath multicast aggregate-routes"
    default_value: false

  allocate_delay:
    config_get: "show fabricpath timers"
    config_get_token: '/^Allocate Delay Timer\s+:\s+(\d+)/'
    config_set: "%s fabricpath timers allocate-delay %s"
    default_value: 10

  auto_switch_id: 
    config_get: "show fabricpath switch-id"
    config_get_token: '/^\*\s+(\d+).*No$/'

  feature:
    config_get: "show feature-set"
    config_get_token: '/^fabricpath[\s]+[\d]+[\s]+(\S+)/'
    config_set: "%s feature-set fabricpath"

  feature_install:
    config_set: "%s install feature-set fabricpath"

  graceful_merge:
    config_get: "show run fabricpath"
    config_get_token: '/^fabricpath graceful\-merge (\S+)/'
    config_set: "%s fabricpath graceful-merge disable"
    default_value: true

  linkup_delay:
    config_get: "show fabricpath timers"
    config_get_token: '/^Link\-up Delay Timer\s+:\s+(\d+)/'
    config_set: "%s fabricpath timers linkup-delay %s"
    default_value: 10

  linkup_delay_always:
    config_get: "show fabricpath timers"
    config_get_token: '/^Link\-up Delay Timer\s+:\s+\d+\s+\((always)\)$/'
    config_set: "%s fabricpath timers linkup-delay always"
    default_value: false

  linkup_delay_enable:
    config_get: "show fabricpath timers"
    config_get_token: '/^Link\-up Delay\s+:\s+(\S+)/'
    config_set: "%s fabricpath linkup-delay"
    default_value: true

  loadbalance_algorithm:
    config_get: "show fabricpath load-balance"
    config_get_token: '/^Hash Control: (\S+)/'
    config_set: "%s fabricpath load-balance %s"
    default_value: "symmetric"

  loadbalance_multicast_rotate:
    config_get: "show fabricpath load-balance | begin Ftag"
    config_get_token: '/^Rotate amount: (\d+)/'
    default_value: 5

  loadbalance_multicast_has_vlan:
    config_get: "show fabricpath load-balance | begin Ftag"
    config_get_token: '/^Use VLAN: (\S+)/'
    default_value: false

  loadbalance_multicast_reset:
    config_set: "no fabricpath load-balance multicast"

  loadbalance_multicast_set:
    config_set: 'fabricpath load-balance multicast <rotate_amt> <inc_vlan>'

  loadbalance_unicast_layer:
    config_get: "show fabricpath load-balance"
    config_get_token: '/^L3\/L4 Preference: (\S+)/'
    default_value: "mixed"

  loadbalance_unicast_rotate:
    config_get: "show fabricpath load-balance"
    config_get_token: '/^Rotate amount: (\d+)/'
    default_value: 5

  loadbalance_unicast_has_vlan:
    config_get: "show fabricpath load-balance"
    config_get_token: '/^Use VLAN: (\S+)/'
    default_value: false

  loadbalance_unicast_reset:
    config_set: "no fabricpath load-balance unicast"

  loadbalance_unicast_set:
    config_set: 'fabricpath load-balance unicast <pref> <rotate_amt> <inc_vlan>'

  mode:
    config_get: "show run fabricpath"
    config_get_token: '/^fabricpath mode (\S+)/'
    config_set: "%s fabricpath mode transit"
    default_value: "normal"

  switch_id:
    config_get: "show run fabricpath"
    config_get_token: '/^fabricpath switch-id (\d+)/'
    config_set: "fabricpath switch-id %s"

  transition_delay:
    config_get: "show fabricpath timers"
    config_get_token: '/^Transition Delay Timer\s+:\s+(\d+)/'
    config_set: "%s fabricpath timers transition-delay %s"
    default_value: 10

  ttl_multicast:
    config_get: "show fabricpath ttl"
    config_get_token: '/^Multicast TTL:\s+(\d+) hops/'
    config_set: "%s fabricpath ttl multicast %s"
    default_value: 32

  ttl_unicast:
    config_get: "show fabricpath ttl"
    config_get_token: '/^Unicast TTL:\s+(\d+) hops/'
    config_set: "%s fabricpath ttl unicast %s"
    default_value: 32

fabricpath_topology:
  all_topos:
    config_get: "show fabricpath topology"
    config_get_token: '/^\S+[\s]+(\d+)[\s]+/'

  create:
    config_set: ["fabricpath topology %s" , "end"]

  description:
    config_get: "show fabricpath topology"
    config_get_token: '/^(\S+)[\s]+%d+[\s]+\S+/'
    config_set: ["fabricpath topology %d" , "%s description %s", "end"]
    default_value: ""

  destroy:
    config_set: "no fabricpath topology %s"

  member_vlans:
    config_get: "show fabricpath topology vlan"
    config_get_token: '/^\S+[\s]+%d+[\s]+(\S+)/'
    config_set: ["fabricpath topology %d" , "%s member vlan %s", "end"]
    default_value: "--"

  state:
    config_get: "show fabricpath topology"
    config_get_token: '/^\S+[\s]+%d+[\s]+(\S+)/'
    default_value: "up"

interface:
  admin_state_ethernet_noswitchport_shutdown:
    default_value: "shutdown"

  ipv4_redirects_loopback:
    default_value: false
    config_set: ~
    config_get: ~
    config_get_token: ~
    test_config_result:
      false: RuntimeError
      true: RuntimeError

  negotiate_auto_ethernet:
    config_set: ~
    config_get: ~
    config_get_token: ~
    default_value: false

  negotiate_auto_portchannel:
    config_set: ~
    config_get: ~
    config_get_token:
    default_value: false

inventory:
  inventory:
    test_config_get_regex: [!ruby/regexp '/.*\nNAME: "(.+)",\s+DESCR: "(.+)"\s+\nPID: (\S+)\s+,\s+VID: (.+) ,\s+SN: (.+)\s+\n/', !ruby/regexp '/.*NAME: "(.+)",\s+DESCR: "(.+)"\s+PID: (\S+)\s+,\s+VID: (.+) ,\s+SN: (.+)\s+\n/']

show_version:
  description:
    test_config_get_regex: !ruby/regexp '/.*Hardware\n  cisco (\w+ \w+ \(\w+ \w+\) \w+).*/'

supported:
  aggregate_multicast_routes:
    default_value: true
  
  linkup_delay_always:
    default_value: true
  
  linkup_delay_enable:
    default_value: true
    
  loadbalance_algorithm:
    default_value: 'symmetric'

  loadbalance_multicast:
    default_value: 'combined'
    
  loadbalance_multicast_rotate:
    default_value: true
   
  loadbalance_unicast:
    default_value: 'combined'
    
  loadbalance_unicast_rotate:
    default_value: true

vlan:
  mode:
    config_get: "show vlan"
    config_get_token: '/^%d+\s+enet\s+(\S+)\s/'
    config_set: ["vlan %d" , "%s mode %s", "end"]
    default_value: "ce"

vtp:
  version:
    test_config_result:
      3: 3

