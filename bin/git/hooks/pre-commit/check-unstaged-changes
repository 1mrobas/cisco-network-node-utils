#!/usr/bin/env ruby
#
# Check if a staged file has unstaged changes and print a warning

staged_files = %x( git diff --name-only --staged ).split(' ')
unstaged_files = %x( git diff --name-only ).split(' ')
files = (staged_files << unstaged_files).flatten!

if files.length != files.uniq.length
  puts "Warning: a staged file has unstaged changes!"
  print "Continue anyway? [y/N] "
  input = gets.strip
  exit input =~ /^y/i ? 0 : -1
end

exit 0
